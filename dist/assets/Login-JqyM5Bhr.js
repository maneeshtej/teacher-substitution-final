import{j as t}from"./index-DcfvNCTE.js";import{b as a}from"./vendor-xatzf0Rc.js";import{g as N}from"./fetchUtils-DSPvWvVt.js";import{s as p,u as k}from"./App-BarifcCs.js";import{u as L}from"./useTeachStore-oF6TMzqJ.js";const E=async(s,r)=>{const{data:c,error:n}=await p.auth.signInWithPassword({email:s,password:r});return n?(console.error("Sign-in error:",n),{data:null,error:n}):{data:c,error:null}},x=async()=>{const{data:s,error:r}=await p.auth.getUser();return r?(console.error("Error checking user:",r.message),!1):!!(s!=null&&s.user)};function F(){const[s,r]=a.useState(null),[c,n]=a.useState(null),[S,U]=a.useState({}),[h,l]=a.useState(!1),{setteacherid:f,setteachername:m,setteacheremail:g,setteacherdetails:v}=L(),u=k();a.useEffect(()=>{(async()=>{try{await x()&&u("/home")}catch(o){console.error("error",o)}})()},[]),a.useEffect(()=>{},[s,c]);const j=e=>{e||console.error("Please check, username no e"),r(e.target.value??null)},y=e=>{e||console.error("Please check, password no e"),n(e.target.value??null)},w=async()=>{l(!0);try{const{data:e,error:o}=await E(s,c);if(o){console.error("Login error:",o.message),l(!1);return}if(e!=null&&e.user){const b=await x();if(l(!1),b){e.user.email&&g(e.user.email);try{const{data:i,error:d}=await N(s);d&&console.error("Error fetching teacher details:",d),v(i),f(i[0].id),m(i[0].name)}catch(i){console.error("Unexpected error fetching teacher details:",i)}u("/home")}}}catch(e){console.error("Unexpected error:",e)}finally{l(!1)}};return t.jsxs("div",{className:"fixed overflow-y-hidden h-[100vh] w-[100vw] text-textc",children:[t.jsx("div",{className:`fixed h-[100vh] w-[100vw] backdrop-blur-2xl z-10 
    transition-opacity duration-300 ease-in-out flex items-center justify-center
    ${h?"opacity-100":"opacity-0 pointer-events-none"}
  `,children:t.jsx("span",{className:"text-black text-[30px]",children:"Loading"})}),t.jsxs("div",{className:"flex flex-col h-[30vh]",children:[t.jsxs("div",{className:"flex items-center justify-start flex-1 gap-[5px] h-[10vh] pl-[10px] pr-[13px] text-black",children:[t.jsx("div",{className:"h-[30px] w-[30px] rounded-[100px] bg-gray-400 "}),"Login",t.jsx("div",{className:"ml-auto",children:"V"})]}),t.jsx("span",{className:"flex items-center justify-center flex-3 text-black text-[40px] font-[900] font-cursive",children:"Teacher Substitution"})]}),t.jsx("div",{className:"transition-all duration-500 ease-in-out",children:t.jsx("div",{className:`flex items-center justify-start
            flex-col gap-[30px] h-[100vh] bg-[#FAC375] sm:bg-[#ffefd8] transition-all duration-500 ease-in-out`,children:t.jsxs("div",{className:"flex flex-col gap-[20px] items-center justify-center pb-[10px] w-[100%] h-[40vh] transition-all duration-200 ease-in-out",children:[t.jsx("div",{className:"flex flex-col items-center justify-center gap-[5px] w-[100%]",children:t.jsx("input",{type:"text",className:"h-[7vh] w-[min(80%,400px)] rounded-[10px] p-[10px] text-[13px] focus:outline-0 focus:p-[15px] transition-all duration-500 ease-in-out",placeholder:"Username",onChange:e=>{j(e)},style:{backgroundColor:"rgba(0, 0, 0, 0.4)",backdropFilter:"saturate(160%) blur(10px)"}})}),t.jsx("div",{className:"flex flex-col items-center justify-center gap-[5px] w-[100%] transition-all duration-200 ease-in-out",children:t.jsx("input",{type:"password",className:"h-[7vh] w-[min(80%,400px)] rounded-[10px] p-[10px] text-[13px] focus:outline-0 focus:p-[15px] transition-all duration-500 ease-in-out",placeholder:"Password",style:{backgroundColor:"rgba(0, 0, 0, 0.4)",backdropFilter:"saturate(160%) blur(10px)"},onChange:e=>{y(e)}})}),t.jsx("div",{className:"flex items-center justify-center h-[7vh] w-[min(40%,200px)] rounded-[10px] mt-[15px] bg-backgroundc",onClick:()=>{w()},children:"Log in"})]})})})]})}export{F as default};
